<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Florer√≠as en Cajamarca | Florer√≠asB</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" href="https://img.icons8.com/ios-filled/50/flower.png">
  <style>
    @import url('https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap');

    body {
      font-family: 'Montserrat', Arial, sans-serif;
      background: #fff;
      color: #333;
      margin: 0;
      padding: 0;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #ffe4ef;
      padding: 8px 24px;
      font-size: 15px;
    }

    .top-bar .icon img { vertical-align: middle; }
    .top-bar .currency { margin: 0 8px; }
    .top-bar .exchange { color: #c06; font-weight: 600; }
    .top-bar .search { padding: 4px 8px; border-radius: 4px; border: 1px solid #ccc; }
    .top-bar .search-btn { background: #c06; border: none; border-radius: 4px; padding: 4px 8px; cursor: pointer; }

    .mega-menu {
      background: #fff;
      border-bottom: 1px solid #f3c1d1;
      font-weight: 700;
    }
    .mega-menu ul {
      display: flex;
      list-style: none;
      margin: 0; padding: 0;
    }
    .mega-menu li {
      position: relative;
    }
    .mega-menu a {
      display: block;
      padding: 16px 20px;
      color: #c06;
      text-decoration: none;
      transition: background 0.2s;
    }
    .mega-menu a:hover { background: #ffe4ef; }
    .dropdown-content {
      display: none;
      position: absolute;
      left: 0; top: 100%;
      background: #fff;
      min-width: 180px;
      box-shadow: 0 2px 8px rgba(200,0,100,0.08);
      z-index: 10;
      border-radius: 0 0 8px 8px;
    }
    .dropdown.open .dropdown-content { display: block; }
    .dropdown-content a {
      padding: 10px 18px;
      color: #333;
      font-weight: 400;
    }
    .dropdown-content a:hover { background: #ffe4ef; color: #c06; }

    .breadcrumbs {
      margin: 24px 32px 0 32px;
      font-size: 14px;
      color: #888;
    }
    .breadcrumbs a { color: #c06; text-decoration: none; }
    .breadcrumbs span { color: #333; }

    .page-title {
      margin: 8px 32px 24px 32px;
      font-size: 2.2em;
      color: #c06;
      font-weight: 700;
    }

    .main-content {
      display: flex;
      gap: 32px;
      margin: 0 32px 32px 32px;
    }

    .filters {
      min-width: 220px;
      background: #fff6fa;
      border-radius: 12px;
      padding: 24px 16px;
      box-shadow: 0 2px 8px rgba(200,0,100,0.05);
      font-size: 15px;
      height: fit-content;
    }
    .filters h2 { color: #c06; font-size: 1.2em; margin-bottom: 12px; }
    .filter-group { margin-bottom: 18px; }
    .filter-group h3 { margin: 8px 0; color: #c06; font-size: 1em; }
    .filter-group label { display: block; margin: 4px 0; }
    .filter-group input[type="number"] {
      width: 80px; margin: 4px 4px 0 0; padding: 2px 6px; border-radius: 4px; border: 1px solid #ccc;
    }

    .products {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 24px;
      width: 100%;
    }

    .product-card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(200,0,100,0.07);
      padding: 18px;
      text-align: center;
      transition: box-shadow 0.2s;
    }
    .product-card:hover { box-shadow: 0 4px 16px rgba(200,0,100,0.12); }
    .product-card img {
      width: 180px; height: 180px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 12px;
      background: #ffe4ef;
    }
    .product-card h4 { color: #c06; margin: 8px 0 6px 0; font-size: 1.1em; }
    .price {
      margin: 8px 0 12px 0;
      font-size: 1em;
    }
    .old-price, .old-price-usd {
      text-decoration: line-through;
      color: #888;
      margin-right: 6px;
    }
    .current-price, .current-price-usd {
      color: #c06;
      font-weight: 700;
      margin-right: 6px;
    }
    .buy-btn {
      background: #c06;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 8px 18px;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.2s;
    }
    .buy-btn:hover { background: #a04; }

    .footer {
      background: #ffe4ef;
      padding: 32px 24px 16px 24px;
      text-align: center;
      font-size: 15px;
      color: #333;
      margin-top: 32px;
      border-top: 1px solid #f3c1d1;
    }
    .footer-links a {
      margin: 0 12px;
      color: #c06;
      text-decoration: none;
      font-weight: 700;
    }
    .footer-social a { margin: 0 8px; }
    .footer-payments {
      margin: 16px 0;
      font-size: 1em;
    }
    .pay-icon {
      height: 24px;
      margin: 0 4px;
      vertical-align: middle;
    }
    .footer-legal { margin-top: 12px; color: #888; font-size: 0.95em; }

    @media (max-width: 900px) {
      .main-content { flex-direction: column; gap: 0; }
      .filters { margin-bottom: 24px; }
      .products { grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); }
    }

    body.usd .old-price, body.usd .current-price { display: none; }
    body.usd .old-price-usd, body.usd .current-price-usd { display: inline; }
    .old-price-usd, .current-price-usd { display: none; }
  </style>
</head>
<body>
  <!-- Barra superior -->
  <header class="top-bar">
    <div class="left-icons">
      <!-- Logo de la p√°gina (m√°s grande) -->
      <span class="logo" style="margin-right:18px;">
        <img src="IO EE.png" alt="Florer√≠asB" style="height:56px;vertical-align:middle;">
      </span>
      <span class="icon"><img src="https://img.icons8.com/ios-filled/24/language.png" alt="Idioma"></span>
      <select class="currency">
        <option value="PEN">S/ (PEN)</option>
        <option value="USD">USD ($)</option>
      </select>
      <span class="exchange">1 USD ‚âà 3.80 S/</span>
    </div>
    <div class="right-icons">
      <span class="icon"><img src="https://img.icons8.com/ios-filled/24/shopping-cart.png" alt="Carrito"></span>
      <input type="text" class="search" placeholder="Buscar...">
      <button class="search-btn"><img src="https://img.icons8.com/ios-filled/20/search.png" alt="Buscar"></button>
    </div>
  </header>

  <!-- Men√∫ mega -->
  <nav class="mega-menu">
    <ul>
      <li class="dropdown">
        <a href="#">Ocasiones</a>
        <div class="dropdown-content">
          <a href="#">Cumplea√±os</a>
          <a href="#">Aniversario</a>
          <a href="#">Amor</a>
          <a href="#">Condolencias</a>
          <a href="#">Graduaci√≥n</a>
        </div>
      </li>
      <li class="dropdown">
        <a href="#">Flores</a>
        <div class="dropdown-content">
          <a href="#">Rosas</a>
          <a href="#">Lirios</a>
          <a href="#">Tulipanes</a>
          <a href="#">Girasoles</a>
        </div>
      </li>
      <li class="dropdown">
        <a href="#">Cajas y Ramos</a>
        <div class="dropdown-content">
          <a href="#">Cajas cil√≠ndricas</a>
          <a href="#">Ramos cl√°sicos</a>
          <a href="#">Bouquets</a>
        </div>
      </li>
      <li class="dropdown">
        <a href="#">Canastas y Boxes Gourmet</a>
        <div class="dropdown-content">
          <a href="#">Canastas de frutas</a>
          <a href="#">Boxes dulces</a>
          <a href="#">Boxes salados</a>
        </div>
      </li>
      <li class="dropdown">
        <a href="#">Regalos</a>
        <div class="dropdown-content">
          <a href="#">Peluches</a>
          <a href="#">Globos</a>
          <a href="#">Tarjetas</a>
        </div>
      </li>
      <li class="dropdown">
        <a href="#">Provincia</a>
        <div class="dropdown-content">
          <a href="#">Cajabamba</a>
          <a href="#">Cajamarca</a>
          <a href="#">Celend√≠n</a>
          <a href="#">Chota</a>
          <a href="#">Contumaza</a>
          <a href="#">Cutervo</a>
          <a href="#">Hualgayoc</a>
          <a href="#">Ja√©n</a>
          <a href="#">San Ignacio</a>
          <a href="#">San Marcos</a>
          <a href="#">San Miguel</a>
          <a href="#">San Pablo</a>
          <a href="#">Santa Cruz</a>
        </div>
      </li>
    </ul>
  </nav>

  <!-- Breadcrumbs y t√≠tulo -->
  <div class="breadcrumbs">
    <a href="#"></a>  <a href="#"></a>  <span>Floreria Cajamarca</span>
  </div>
  <h1 class="page-title">Floreria Cajamarca</h1>

  <main class="main-content">
    <!-- Filtros laterales -->
    <aside class="filters">
      <h2>Filtros</h2>
      <div class="filter-group">
        <h3>Tipo de flor</h3>
        <label><input type="checkbox"> Rosas (12)</label>
        <label><input type="checkbox"> Lirios (5)</label>
        <label><input type="checkbox"> Tulipanes (3)</label>
        <label><input type="checkbox"> Girasoles (2)</label>
      </div>
      <div class="filter-group">
        <h3>Color</h3>
        <label><input type="checkbox"> Rojo</label>
        <label><input type="checkbox"> Blanco</label>
        <label><input type="checkbox"> Amarillo</label>
        <label><input type="checkbox"> Rosado</label>
      </div>
      <div class="filter-group">
        <h3>Cantidad de flores</h3>
        <label><input type="checkbox"> 12</label>
        <label><input type="checkbox"> 24</label>
        <label><input type="checkbox"> 36</label>
      </div>
      <div class="filter-group">
        <h3>Precio</h3>
        <input type="number" placeholder="Min S/" min="0">
        <input type="number" placeholder="Max S/" min="0">
      </div>
      <button id="applyFilterBtn" style="width:100%;margin-top:12px;background:#c06;color:#fff;border:none;border-radius:6px;padding:10px 0;font-size:1em;font-weight:700;cursor:pointer;">Aplicar filtro</button>
      <div id="selectedFilters" style="margin-top:12px;font-size:0.98em;color:#c06;"></div>
    </aside>

    <!-- Listado de productos -->
    <section class="products">
      <div class="product-card">
        <img src="https://via.placeholder.com/180x180?text=Joyce" alt="Modelo Joyce">
        <h4>Modelo Joyce</h4>
        <p class="price">
          <span class="old-price">S/ 180</span>
          <span class="old-price-usd">$47</span>
          <span class="current-price">S/ 150</span>
          <span class="current-price-usd">$39</span>
        </p>
        <button class="buy-btn">Comprar</button>
      </div>
      <div class="product-card">
        <img src="https://via.placeholder.com/180x180?text=Box+36+Rosas" alt="Box cil√≠ndrico con 36 rosas">
        <h4>Box cil√≠ndrico con 36 rosas</h4>
        <p class="price">
          <span class="old-price">S/ 220</span>
          <span class="old-price-usd">$58</span>
          <span class="current-price">S/ 190</span>
          <span class="current-price-usd">$50</span>
        </p>
        <button class="buy-btn">Comprar</button>
      </div>
      <div class="product-card">
        <img src="https://via.placeholder.com/180x180?text=Tulipanes" alt="Bouquet de tulipanes">
        <h4>Bouquet de tulipanes</h4>
        <p class="price">
          <span class="old-price">S/ 160</span>
          <span class="old-price-usd">$42</span>
          <span class="current-price">S/ 130</span>
          <span class="current-price-usd">$34</span>
        </p>
        <button class="buy-btn">Comprar</button>
      </div>
      <div class="product-card">
        <img src="https://via.placeholder.com/180x180?text=Rosas+Rojas" alt="Rosas Rojas 24">
        <h4>Rosas rojas 24</h4>
        <p class="price">
          <span class="old-price">S/ 200</span>
          <span class="old-price-usd">$52</span>
          <span class="current-price">S/ 170</span>
          <span class="current-price-usd">$44</span>
        </p>
        <button class="buy-btn">Comprar</button>
      </div>
      <div class="product-card">
        <img src="https://via.placeholder.com/180x180?text=Lirios+Blancos" alt="Lirios Blancos 12">
        <h4>Lirios blancos 12</h4>
        <p class="price">
          <span class="old-price">S/ 140</span>
          <span class="old-price-usd">$36</span>
          <span class="current-price">S/ 120</span>
          <span class="current-price-usd">$31</span>
        </p>
        <button class="buy-btn">Comprar</button>
      </div>
      <div class="product-card">
        <img src="https://via.placeholder.com/180x180?text=Tulipanes+Amarillos" alt="Tulipanes Amarillos 36">
        <h4>Tulipanes amarillos 36</h4>
        <p class="price">
          <span class="old-price">S/ 250</span>
          <span class="old-price-usd">$65</span>
          <span class="current-price">S/ 210</span>
          <span class="current-price-usd">$55</span>
        </p>
        <button class="buy-btn">Comprar</button>
      </div>
      <div class="product-card">
        <img src="https://via.placeholder.com/180x180?text=Girasoles+Rosados" alt="Girasoles Rosados 12">
        <h4>Girasoles rosados 12</h4>
        <p class="price">
          <span class="old-price">S/ 130</span>
          <span class="old-price-usd">$34</span>
          <span class="current-price">S/ 110</span>
          <span class="current-price-usd">$29</span>
        </p>
        <button class="buy-btn">Comprar</button>
      </div>
      <!-- Ejemplo de productos para Ocasiones -->
      <div class="product-card">
        <img src="https://via.placeholder.com/180x180?text=Rosas+Amor" alt="Rosas Amor 12">
        <h4>Rosas rojas 12 - Amor</h4>
        <p class="price">
          <span class="old-price">S/ 120</span>
          <span class="old-price-usd">$32</span>
          <span class="current-price">S/ 99</span>
          <span class="current-price-usd">$26</span>
        </p>
        <button class="buy-btn">Comprar</button>
      </div>
      <div class="product-card">
        <img src="https://via.placeholder.com/180x180?text=Tulipanes+Cumplea√±os" alt="Tulipanes Cumplea√±os 24">
        <h4>Tulipanes amarillos 24 - Cumplea√±os</h4>
        <p class="price">
          <span class="old-price">S/ 180</span>
          <span class="old-price-usd">$47</span>
          <span class="current-price">S/ 150</span>
          <span class="current-price-usd">$39</span>
        </p>
        <button class="buy-btn">Comprar</button>
      </div>
      <!-- Ejemplo de producto para Cajas y Ramos -->
      <div class="product-card">
        <img src="https://via.placeholder.com/180x180?text=Caja+Bouquet" alt="Caja Bouquet 36 Rosas">
        <h4>Caja bouquet 36 rosas - Aniversario</h4>
        <p class="price">
          <span class="old-price">S/ 250</span>
          <span class="old-price-usd">$65</span>
          <span class="current-price">S/ 210</span>
          <span class="current-price-usd">$55</span>
        </p>
        <button class="buy-btn">Comprar</button>
      </div>
      <!-- Ejemplo de producto para Canastas y Boxes Gourmet -->
      <div class="product-card">
        <img src="https://via.placeholder.com/180x180?text=Canasta+Frutas" alt="Canasta Frutas Gourmet">
        <h4>Canasta de frutas gourmet - Condolencias</h4>
        <p class="price">
          <span class="old-price">S/ 180</span>
          <span class="old-price-usd">$47</span>
          <span class="current-price">S/ 155</span>
          <span class="current-price-usd">$40</span>
        </p>
        <button class="buy-btn">Comprar</button>
      </div>
      <!-- Ejemplo de producto para Regalos -->
      <div class="product-card">
        <img src="https://via.placeholder.com/180x180?text=Peluches+Globos" alt="Peluches y Globos">
        <h4>Peluches y globos - Graduaci√≥n</h4>
        <p class="price">
          <span class="old-price">S/ 90</span>
          <span class="old-price-usd">$24</span>
          <span class="current-price">S/ 75</span>
          <span class="current-price-usd">$20</span>
        </p>
        <button class="buy-btn">Comprar</button>
      </div>
      <!-- Ejemplo de producto para Provincias/Extranjero -->
      <div class="product-card">
        <img src="https://via.placeholder.com/180x180?text=Rosas+Arequipa" alt="Rosas Arequipa 24">
        <h4>Rosas rojas 24 - Arequipa</h4>
        <p class="price">
          <span class="old-price">S/ 210</span>
          <span class="old-price-usd">$55</span>
          <span class="current-price">S/ 180</span>
          <span class="current-price-usd">$47</span>
        </p>
        <button class="buy-btn">Comprar</button>
      </div>
      <!-- Puedes agregar m√°s productos aqu√≠ -->
    </section>
  </main>

  <!-- Carrito Modal (panel lateral minimalista) -->
  <div id="cartModal" style="display:none;position:fixed;top:0;right:0;width:350px;max-width:100vw;height:100vh;background:#fff;box-shadow:-2px 0 16px rgba(200,0,100,0.12);z-index:9999;overflow-y:auto;transition:right 0.3s;">
    <div style="padding:18px 24px 10px 24px;background:#ffe4ef;border-bottom:1px solid #f3c1d1;display:flex;justify-content:space-between;align-items:center;">
      <span style="color:#c06;font-size:1.2em;font-weight:700;">Carrito de compras</span>
      <button id="cartCloseBtn" style="background:none;border:none;font-size:1.7em;color:#c06;cursor:pointer;">&times;</button>
    </div>
    <div id="cartItems" style="padding:16px 24px;"></div>
    <div style="padding:18px 24px;background:#fff;border-top:1px solid #f3c1d1;">
      <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
        <span>Subtotal:</span>
        <span id="cartSubtotal">S/ 0.00</span>
      </div>
      <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
        <span>Env√≠o:</span>
        <input type="number" id="cartShipping" min="0" value="15" step="1" style="width:80px;padding:2px 6px;border-radius:4px;border:1px solid #ccc;">
      </div>
      <div style="display:flex;justify-content:space-between;font-weight:700;color:#c06;font-size:1.1em;margin-bottom:14px;">
        <span>Total:</span>
        <span id="cartTotal">S/ 0.00</span>
      </div>
      <button id="cartCheckoutBtn" style="width:100%;background:#c06;color:#fff;border:none;border-radius:6px;padding:10px 0;font-size:1em;font-weight:700;cursor:pointer;">Finalizar compra</button>
      <button id="cartEmptyBtn" style="width:100%;background:#fff;color:#c06;border:1px solid #c06;border-radius:6px;padding:10px 0;font-size:1em;font-weight:700;cursor:pointer;margin-top:8px;">Vaciar carrito</button>
    </div>
  </div>
  <!-- Mensaje flotante -->
  <div id="cartMessage" style="position:fixed;top:24px;right:24px;background:#c06;color:#fff;padding:12px 24px;border-radius:8px;font-size:1em;box-shadow:0 2px 12px rgba(200,0,100,0.18);z-index:99999;opacity:0;pointer-events:none;transition:opacity 0.3s;"></div>

  <script>
    // Men√∫ mega desplegable
    document.querySelectorAll('.dropdown').forEach(function(item){
      item.addEventListener('mouseenter', function(){
        this.classList.add('open');
      });
      item.addEventListener('mouseleave', function(){
        this.classList.remove('open');
      });
    });

    // Cambio de moneda
    document.querySelector('.currency').addEventListener('change', function(e){
      document.body.classList.toggle('usd', e.target.value === 'USD');
    });

    // --- Carrito de compras ---
    let cart = [];
    const cartIcon = document.querySelector('.right-icons .icon img[alt="Carrito"]');
    const cartModal = document.getElementById('cartModal');
    const cartCloseBtn = document.getElementById('cartCloseBtn');
    const cartItems = document.getElementById('cartItems');
    const cartSubtotal = document.getElementById('cartSubtotal');
    const cartShipping = document.getElementById('cartShipping');
    const cartTotal = document.getElementById('cartTotal');
    const cartCheckoutBtn = document.getElementById('cartCheckoutBtn');
    const cartEmptyBtn = document.getElementById('cartEmptyBtn');
    const cartMessage = document.getElementById('cartMessage');

    // --- Contador din√°mico en icono carrito ---
    let cartCountSpan = document.createElement('span');
    cartCountSpan.id = 'cartCount';
    cartCountSpan.style.position = 'absolute';
    cartCountSpan.style.top = '-7px';
    cartCountSpan.style.right = '-7px';
    cartCountSpan.style.background = '#c06';
    cartCountSpan.style.color = '#fff';
    cartCountSpan.style.fontSize = '13px';
    cartCountSpan.style.fontWeight = '700';
    cartCountSpan.style.borderRadius = '50%';
    cartCountSpan.style.padding = '2px 7px';
    cartCountSpan.style.minWidth = '22px';
    cartCountSpan.style.textAlign = 'center';
    cartCountSpan.style.boxShadow = '0 2px 6px rgba(200,0,100,0.12)';
    cartCountSpan.textContent = '0';
    cartIcon.parentElement.style.position = 'relative';
    cartIcon.parentElement.appendChild(cartCountSpan);

    // --- Persistencia ---
    function saveCart() { localStorage.setItem('cart', JSON.stringify(cart)); }
    function loadCart() { cart = JSON.parse(localStorage.getItem('cart') || '[]'); }

    // --- Renderizar carrito ---
    function renderCart() {
      cartItems.innerHTML = '';
      let subtotal = 0;
      cart.forEach(item => {
        subtotal += item.price * item.qty;
        let div = document.createElement('div');
        div.style.display = 'flex';
        div.style.alignItems = 'center';
        div.style.background = '#fff';
        div.style.borderRadius = '10px';
        div.style.marginBottom = '16px';
        div.style.boxShadow = '0 2px 8px rgba(200,0,100,0.07)';
        div.style.padding = '10px';
        div.innerHTML = `
          <img src="${item.img}" alt="${item.name}" style="width:54px;height:54px;object-fit:cover;border-radius:8px;margin-right:12px;background:#ffe4ef;border:1px solid #f3c1d1;">
          <div style="flex:1;min-width:0;">
            <div style="font-weight:700;color:#c06;font-size:1em;margin-bottom:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${item.name}</div>
            <div style="font-size:0.98em;color:#333;margin-bottom:4px;">S/ ${item.price.toFixed(2)}</div>
            <div style="display:flex;align-items:center;gap:4px;margin-bottom:2px;">
              <button class="qty-btn" data-action="dec" data-id="${item.id}" style="background:#c06;color:#fff;border:none;border-radius:50%;width:22px;height:22px;font-size:1em;cursor:pointer;">-</button>
              <span>${item.qty}</span>
              <button class="qty-btn" data-action="inc" data-id="${item.id}" style="background:#c06;color:#fff;border:none;border-radius:50%;width:22px;height:22px;font-size:1em;cursor:pointer;">+</button>
            </div>
            <div style="font-size:0.97em;color:#ffd700;font-weight:700;">Subtotal: S/ ${(item.price * item.qty).toFixed(2)}</div>
          </div>
          <button class="cart-item-remove" data-id="${item.id}" title="Eliminar" style="background:none;border:none;color:#c06;font-size:1.2em;margin-left:8px;cursor:pointer;">&#128465;</button>
        `;
        cartItems.appendChild(div);
      });
      cartCountSpan.textContent = cart.reduce((a, b) => a + b.qty, 0);
      cartSubtotal.textContent = `S/ ${subtotal.toFixed(2)}`;
      const envio = parseFloat(cartShipping.value) || 0;
      cartTotal.textContent = `S/ ${(subtotal + envio).toFixed(2)}`;
      saveCart();
    }

    // --- Mostrar/Ocultar modal carrito ---
    cartIcon.parentElement.onclick = () => { cartModal.style.display = 'block'; };
    cartCloseBtn.onclick = () => { cartModal.style.display = 'none'; };

    // --- Cambiar cantidad y eliminar producto ---
    cartItems.onclick = function(e) {
      if (e.target.classList.contains('qty-btn')) {
        const id = e.target.dataset.id;
        const action = e.target.dataset.action;
        const idx = cart.findIndex(i => i.id == id);
        if (idx > -1) {
          if (action === 'inc') cart[idx].qty++;
          if (action === 'dec' && cart[idx].qty > 1) cart[idx].qty--;
          renderCart();
        }
      }
      if (e.target.classList.contains('cart-item-remove')) {
        const id = e.target.dataset.id;
        if (confirm('¬øEliminar este producto del carrito?')) {
          cart = cart.filter(i => i.id != id);
          renderCart();
          showMessage('Producto eliminado');
        }
      }
    };

    // --- Cambiar costo de env√≠o ---
    cartShipping.oninput = () => renderCart();

    // --- Vaciar carrito ---
    cartEmptyBtn.onclick = function() {
      if (cart.length === 0) return;
      if (confirm('¬øSeguro que deseas vaciar el carrito?')) {
        cart = [];
        renderCart();
        showMessage('Carrito vaciado');
      }
    };

    // --- Finalizar compra ---
    cartCheckoutBtn.onclick = function() {
      if (cart.length === 0) {
        showMessage('El carrito est√° vac√≠o');
        return;
      }
      window.location.href = 'pago.html'; // Cambia por la URL de tu p√°gina de pago si es necesario
    };

    // --- Mensaje flotante ---
    function showMessage(msg) {
      cartMessage.textContent = msg;
      cartMessage.style.opacity = '1';
      cartMessage.style.pointerEvents = 'auto';
      setTimeout(() => {
        cartMessage.style.opacity = '0';
        cartMessage.style.pointerEvents = 'none';
      }, 1800);
    }

    // --- Agregar producto desde botones existentes ---
    document.querySelectorAll('.products .product-card').forEach((card, idx) => {
      const btn = card.querySelector('.buy-btn');
      btn.onclick = function() {
        const name = card.querySelector('h4').textContent.trim();
        const img = card.querySelector('img').src;
        // Busca el precio current (S/)
        let priceText = card.querySelector('.current-price');
        let price = priceText ? priceText.textContent.replace(/[^\d.]/g, '') : '0';
        price = parseFloat(price) || 0;
        // Genera un id √∫nico por producto
        const id = name.replace(/\s+/g, '_') + '_' + idx;
        const idxCart = cart.findIndex(i => i.id == id);
        if (idxCart > -1) {
          cart[idxCart].qty++;
        } else {
          cart.push({ id, name, price, img, qty: 1 });
        }
        renderCart();
        showMessage('Producto a√±adido al carrito');
        // Animaci√≥n icono
        cartIcon.style.transform = 'scale(1.2)';
        setTimeout(() => cartIcon.style.transform = '', 300);
      };
    });

    // --- Mostrar filtros seleccionados y aplicar ---
    document.getElementById('applyFilterBtn').onclick = function() {
      // Mapeo de filtros
      const filterFlor = Array.from(document.querySelectorAll('.filter-group h3'))
        .find(el => el.textContent.includes('Tipo de flor'))
        .parentElement.querySelectorAll('input[type="checkbox"]');
      const filterColor = Array.from(document.querySelectorAll('.filter-group h3'))
        .find(el => el.textContent.includes('Color'))
        .parentElement.querySelectorAll('input[type="checkbox"]');
      const filterCantidad = Array.from(document.querySelectorAll('.filter-group h3'))
        .find(el => el.textContent.includes('Cantidad'))
        .parentElement.querySelectorAll('input[type="checkbox"]');
      const filterPrecioMin = Array.from(document.querySelectorAll('.filter-group h3'))
        .find(el => el.textContent.includes('Precio'))
        .parentElement.querySelector('input[placeholder*="Min"]');
      const filterPrecioMax = Array.from(document.querySelectorAll('.filter-group h3'))
        .find(el => el.textContent.includes('Precio'))
        .parentElement.querySelector('input[placeholder*="Max"]');

      // Seleccionados
      const flores = Array.from(filterFlor).filter(cb => cb.checked).map(cb => cb.parentElement.textContent.trim());
      const colores = Array.from(filterColor).filter(cb => cb.checked).map(cb => cb.parentElement.textContent.trim());
      const cantidades = Array.from(filterCantidad).filter(cb => cb.checked).map(cb => cb.parentElement.textContent.trim());
      const min = filterPrecioMin.value;
      const max = filterPrecioMax.value;

      let msg = '';
      if (flores.length) msg += `<b>Tipo de flor:</b> ${flores.join(', ')}<br>`;
      if (colores.length) msg += `<b>Color:</b> ${colores.join(', ')}<br>`;
      if (cantidades.length) msg += `<b>Cantidad:</b> ${cantidades.join(', ')}<br>`;
      if (min) msg += `<b>Precio m√≠nimo:</b> S/ ${min}<br>`;
      if (max) msg += `<b>Precio m√°ximo:</b> S/ ${max}<br>`;
      if (!msg) msg = '<i>No has seleccionado ning√∫n filtro.</i>';

      document.getElementById('selectedFilters').innerHTML = msg;

      // Aplica el filtro (llama al filtro original)
      if (typeof filtrarProductos === 'function') filtrarProductos();
    };

    // --- Haz la funci√≥n filtrarProductos global ---
    window.filtrarProductos = (function() {
      // Mapeo de filtros
      const filterFlor = Array.from(document.querySelectorAll('.filter-group h3'))
        .find(el => el.textContent.includes('Tipo de flor'))
        .parentElement.querySelectorAll('input[type="checkbox"]');
      const filterColor = Array.from(document.querySelectorAll('.filter-group h3'))
        .find(el => el.textContent.includes('Color'))
        .parentElement.querySelectorAll('input[type="checkbox"]');
      const filterCantidad = Array.from(document.querySelectorAll('.filter-group h3'))
        .find(el => el.textContent.includes('Cantidad'))
        .parentElement.querySelectorAll('input[type="checkbox"]');
      const filterPrecioMin = Array.from(document.querySelectorAll('.filter-group h3'))
        .find(el => el.textContent.includes('Precio'))
        .parentElement.querySelector('input[placeholder*="Min"]');
      const filterPrecioMax = Array.from(document.querySelectorAll('.filter-group h3'))
        .find(el => el.textContent.includes('Precio'))
        .parentElement.querySelector('input[placeholder*="Max"]');

      const productCards = document.querySelectorAll('.products .product-card');

      // Extrae info de cada producto
      function getProductInfo(card) {
        const nombre = card.querySelector('h4').textContent.toLowerCase();
        const precio = parseFloat(card.querySelector('.current-price').textContent.replace(/[^\d.]/g, '')) || 0;
        // Flor
        let flor = '';
        if (nombre.includes('rosas')) flor = 'rosas';
        else if (nombre.includes('lirios')) flor = 'lirios';
        else if (nombre.includes('tulipanes')) flor = 'tulipanes';
        else if (nombre.includes('girasoles')) flor = 'girasoles';
        // Color
        let color = '';
        if (nombre.includes('rojo')) color = 'rojo';
        else if (nombre.includes('blanco')) color = 'blanco';
        else if (nombre.includes('amarillo')) color = 'amarillo';
        else if (nombre.includes('rosado')) color = 'rosado';
        // Cantidad
        let cantidad = '';
        const matchCantidad = nombre.match(/(\d{2,3})/);
        if (matchCantidad) cantidad = matchCantidad[1];
        return { nombre, precio, flor, color, cantidad };
      }

      // Filtrar productos
      return function filtrarProductos() {
        // Filtros activos
        const flores = Array.from(filterFlor).filter(cb => cb.checked).map(cb => cb.parentElement.textContent.trim().toLowerCase().split(' ')[0]);
        const colores = Array.from(filterColor).filter(cb => cb.checked).map(cb => cb.parentElement.textContent.trim().toLowerCase());
        const cantidades = Array.from(filterCantidad).filter(cb => cb.checked).map(cb => cb.parentElement.textContent.trim());
        const min = parseFloat(filterPrecioMin.value) || null;
        const max = parseFloat(filterPrecioMax.value) || null;

        productCards.forEach(card => {
          const info = getProductInfo(card);
          let visible = true;
          // Flor
          if (flores.length && !flores.includes(info.flor)) visible = false;
          // Color
          if (colores.length && !colores.includes(info.color)) visible = false;
          // Cantidad
          if (cantidades.length && !cantidades.includes(info.cantidad)) visible = false;
          // Precio
          if (min !== null && info.precio < min) visible = false;
          if (max !== null && info.precio > max) visible = false;
          card.style.display = visible ? '' : 'none';
        });
      };
    })();

    // --- Eventos para filtrar en tiempo real ---
    document.querySelectorAll('.filters input').forEach(el => {
      el.addEventListener('change', filtrarProductos);
      el.addEventListener('input', filtrarProductos);
    });

    // --- Filtrado por men√∫ mega ---
    document.querySelectorAll('.mega-menu .dropdown-content a').forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        const opcion = this.textContent.trim().toLowerCase();
        // Si la opci√≥n es una provincia, mostrar todos los productos
        const provincias = [
          'cajabamba','cajamarca','celend√≠n','chota','contumaza','cutervo','hualgayoc',
          'ja√©n','san ignacio','san marcos','san miguel','san pablo','santa cruz'
        ];
        if (provincias.includes(opcion)) {
          document.querySelectorAll('.products .product-card').forEach(card => {
            card.style.display = '';
          });
          document.getElementById('selectedFilters').innerHTML = `<b>Provincia seleccionada:</b> ${this.textContent} <br><i>Mostrando todos los productos disponibles</i>`;
        } else {
          document.querySelectorAll('.products .product-card').forEach(card => {
            const nombre = card.querySelector('h4').textContent.toLowerCase();
            if (nombre.includes(opcion)) {
              card.style.display = '';
            } else {
              card.style.display = 'none';
            }
          });
          document.getElementById('selectedFilters').innerHTML = `<b>Filtro de men√∫:</b> ${this.textContent}`;
        }
      });
    });

    // --- Buscador de productos con autocompletado ---
    const searchInput = document.querySelector('.search');
    const searchBtn = document.querySelector('.search-btn');
    const products = Array.from(document.querySelectorAll('.products .product-card'));
    let autocompleteBox;

    // Crear caja de autocompletado
    function createAutocompleteBox() {
      if (!autocompleteBox) {
        autocompleteBox = document.createElement('div');
        autocompleteBox.style.position = 'absolute';
        autocompleteBox.style.background = '#fff';
        autocompleteBox.style.border = '1px solid #f3c1d1';
        autocompleteBox.style.borderRadius = '6px';
        autocompleteBox.style.boxShadow = '0 2px 8px rgba(200,0,100,0.10)';
        autocompleteBox.style.zIndex = '1000';
        autocompleteBox.style.top = (searchInput.offsetTop + searchInput.offsetHeight + 4) + 'px';
        autocompleteBox.style.left = searchInput.offsetLeft + 'px';
        autocompleteBox.style.width = searchInput.offsetWidth + 'px';
        autocompleteBox.style.maxHeight = '180px';
        autocompleteBox.style.overflowY = 'auto';
        autocompleteBox.style.fontSize = '15px';
        autocompleteBox.style.display = 'none';
        searchInput.parentElement.appendChild(autocompleteBox);
      }
    }

    // Mostrar sugerencias
    searchInput.addEventListener('input', function() {
      createAutocompleteBox();
      const val = this.value.trim().toLowerCase();
      if (!val) {
        autocompleteBox.style.display = 'none';
        return;
      }
      const matches = products
        .map(card => card.querySelector('h4').textContent)
        .filter(name => name.toLowerCase().includes(val));
      if (matches.length === 0) {
        autocompleteBox.innerHTML = '<div style="padding:8px;color:#888;">No hay coincidencias</div>';
      } else {
        autocompleteBox.innerHTML = matches.map(name =>
          `<div class="autocomplete-item" style="padding:8px;cursor:pointer;">${name}</div>`
        ).join('');
      }
      autocompleteBox.style.display = 'block';
    });

    // Seleccionar sugerencia
    document.addEventListener('click', function(e) {
      if (autocompleteBox && e.target.classList.contains('autocomplete-item')) {
        searchInput.value = e.target.textContent;
        autocompleteBox.style.display = 'none';
        searchBtn.click();
      } else if (autocompleteBox && !searchInput.contains(e.target)) {
        autocompleteBox.style.display = 'none';
      }
    });

    // Buscador funcional
    searchBtn.onclick = function(e) {
      e.preventDefault();
      const query = searchInput.value.trim().toLowerCase();
      let found = false;
      products.forEach(card => {
        const nombre = card.querySelector('h4').textContent.toLowerCase();
        if (nombre.includes(query)) {
          card.style.display = '';
          found = true;
        } else {
          card.style.display = 'none';
        }
      });
      if (!found && query) {
        document.getElementById('selectedFilters').innerHTML = `<i>No se encontraron flores para: "${query}"</i>`;
      } else {
        document.getElementById('selectedFilters').innerHTML = '';
      }
    };

    // Buscar al presionar Enter
    searchInput.addEventListener('keydown', function(e) {
      if (e.key === 'Enter') {
        searchBtn.click();
        if (autocompleteBox) autocompleteBox.style.display = 'none';
      }
    });
  </script>

  <footer class="footer">
    <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;">
      <!-- Logo centrado -->
      <img src="IO EE.png" alt="Florer√≠asB" style="height:54px;margin-bottom:12px;border-radius:12px;box-shadow:0 2px 8px rgba(200,0,100,0.10);">
      <!-- Tel√©fono -->
      <div style="font-size:1.15em;color:#c06;font-weight:700;margin-bottom:10px;">
        <span style="margin-right:8px;">üìû</span>952408803
      </div>
      <!-- Redes sociales -->
      <div style="display:flex;gap:18px;justify-content:center;margin-bottom:10px;">
        <a href="https://wa.me/51952408803" target="_blank" title="WhatsApp">
          <img src="https://img.icons8.com/color/48/whatsapp--v1.png" alt="WhatsApp" style="height:32px;">
        </a>
        <a href="https://www.facebook.com/" target="_blank" title="Facebook">
          <img src="https://img.icons8.com/color/48/facebook-new.png" alt="Facebook" style="height:32px;">
        </a>
        <a href="https://www.instagram.com/" target="_blank" title="Instagram">
          <img src="https://img.icons8.com/color/48/instagram-new.png" alt="Instagram" style="height:32px;">
        </a>
      </div>
      <div style="color:#888;font-size:0.98em;margin-top:8px;">
        &copy; 2025 Florer√≠asB. Todos los derechos reservados.
      </div>
    </div>
  </footer>
</body>
</html>